classdef f_obj<handle
    properties
        f_kind=0;
        fval_count=0;
        gval_count=0;
        hval_count=0;
    end
    methods
        function obj=f_obj(kind)
            obj.f_kind=kind;
        end
       

        function f=val(obj,x)
            obj.fval_count=obj.fval_count+1;
            f=-1;
            switch obj.f_kind
                case "rastrigin" 
                    f=x(1)^2 - 10*cos(2*pi*x(2)) - 10*cos(2*pi*x(1)) + x(2)^2 + 20;
                case "ackley"                   
                    f= 6394627848571629/281474976710656 - 20*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5) - exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2);
                case "rosenbrock"
                    f=100*(x(2) - x(1)^2)^2 + (1 - x(1))^2;
                case "beale"
                    f=(x(1)*(x(2) - 1) + 3/2)^2 + (x(1)*(x(2)^2 - 1) + 9/4)^2 + (x(1)*(x(2)^3 - 1) + 21/8)^2;
                case "goldsteinprice"
                    f=((x(1) + x(2) + 1)^2*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19) + 1)*((2*x(1) - 3*x(2))^2*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) + 30);
                case "booth"
                    f=(x(1) + 2*x(2) - 7)^2 + (2*x(1) + x(2) - 5)^2;
                case "matyas"
                    f=(13*x(1)^2)/50 - (12*x(1)*x(2))/25 + (13*x(2)^2)/50;
                case "himmelblau"
                    f=(x(2)^2 + x(1) - 7)^2 + (x(1)^2 + x(2) - 11)^2;
                case "mccormick"
                    f=(5*x(2))/2 - (3*x(1))/2 + sin(x(1) + x(2)) + (x(1) - x(2))^2 + 1;
                case "schaffer"
                    f=(sin(x(1)^2 - x(2)^2)^2 - 1/2)/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 + 1/2;
                otherwise
                    disp("Wrong Choice")
            end
        end

        function gval=grad(obj,x)
            obj.gval_count=obj.gval_count+1;
       %     gval=[0;0];
            switch obj.f_kind
                case "rastrigin"
                    gval=[2*x(1) + 20*pi*sin(2*pi*x(1)); 2*x(2) + 20*pi*sin(2*pi*x(2))];
                case "ackley"
                    g1= pi*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*sin(2*pi*x(1)) + (2*x(1)*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(1/2);
                    g2 = pi*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*sin(2*pi*x(2)) + (2*x(2)*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(1/2);
                    gval=[g1;g2];
                case "rosenbrock"
                    gval=[-400*x(1)*(x(2) - x(1)^2) - 2*(1 - x(1));200*(x(2) - x(1)^2)];
                case "beale"
                     g1 = 2*(x(2)^2 - 1)*(x(1)*(x(2)^2 - 1) + 9/4) + 2*(x(2)^3 - 1)*(x(1)*(x(2)^3 - 1) + 21/8) + 2*(x(1)*(x(2) - 1) + 3/2)*(x(2) - 1);
                     g2 = 2*x(1)*(x(1)*(x(2) - 1) + 3/2) + 6*x(1)*x(2)^2*(x(1)*(x(2)^3 - 1) + 21/8) + 4*x(1)*x(2)*(x(1)*(x(2)^2 - 1) + 9/4);
                     gval=[g1;g2];
                case "goldsteinprice"
                    g1 = ((6*x(1) + 6*x(2) - 14)*(x(1) + x(2) + 1)^2 + (2*x(1) + 2*x(2) + 2)*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19))*((2*x(1) - 3*x(2))^2*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) + 30) + ((x(1) + x(2) + 1)^2*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19) + 1)*((8*x(1) - 12*x(2))*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) - (2*x(1) - 3*x(2))^2*(36*x(2) - 24*x(1) + 32));
                    g2 = ((6*x(1) + 6*x(2) - 14)*(x(1) + x(2) + 1)^2 + (2*x(1) + 2*x(2) + 2)*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19))*((2*x(1) - 3*x(2))^2*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) + 30) - ((x(1) + x(2) + 1)^2*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19) + 1)*((12*x(1) - 18*x(2))*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) - (2*x(1) - 3*x(2))^2*(54*x(2) - 36*x(1) + 48));
                    gval=[g1;g2];
                case "booth"
                      g1 = 10*x(1) + 8*x(2) - 34;
                     g2 = 8*x(1) + 10*x(2) - 38;
                     gval=[g1;g2];
                case "matyas"
                  gval=  [(13*x(1))/25 - (12*x(2))/25;(13*x(2))/25 - (12*x(1))/25];
                case "himmelblau"
                   g1 = 2*x(1) + 4*x(1)*(x(1)^2 + x(2) - 11) + 2*x(2)^2 - 14;
                   g2 =  2*x(2) + 4*x(2)*(x(2)^2 + x(1) - 7) + 2*x(1)^2 - 22;
                    gval=[g1;g2];
                case "mccormick"
                      g1 = 2*x(1) - 2*x(2) + cos(x(1) + x(2)) - 3/2;
                      g2= 2*x(2) - 2*x(1) + cos(x(1) + x(2)) + 5/2;
                       gval=[g1;g2];
                case "schaffer"
                        g1 =(4*x(1)*cos(x(1)^2 - x(2)^2)*sin(x(1)^2 - x(2)^2))/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 - (x(1)*(sin(x(1)^2 - x(2)^2)^2 - 1/2))/(250*(x(1)^2/1000 + x(2)^2/1000 + 1)^3);
                        g2 = - (x(2)*(sin(x(1)^2 - x(2)^2)^2 - 1/2))/(250*(x(1)^2/1000 + x(2)^2/1000 + 1)^3) - (4*x(2)*cos(x(1)^2 - x(2)^2)*sin(x(1)^2 - x(2)^2))/(x(1)^2/1000 + x(2)^2/1000 + 1)^2;
                        gval=[g1;g2];
                otherwise
                    disp("Wrong Choice")
            end
        end


        function hval=hess(obj,x)
            obj.hval_count=obj.hval_count+1;
         %   hval=[0,0;0,0];
            switch obj.f_kind
                case "rastrigin"
                    hval=[ 40*pi^2*cos(2*pi*x(1)) + 2,   0; 0,40*pi^2*cos(2*pi*x(2)) + 2];
                case "ackley"
                     H11= (2*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(1/2) + 2*pi^2*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*cos(2*pi*x(1)) - (x(1)^2*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(5*(x(1)^2/2 + x(2)^2/2)) - (x(1)^2*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(3/2) - pi^2*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*sin(2*pi*x(1))^2;
                     H12= - (x(1)*x(2)*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(5*(x(1)^2/2 + x(2)^2/2)) - (x(1)*x(2)*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(3/2) - pi^2*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*sin(2*pi*x(1))*sin(2*pi*x(2));
                     H21=- (x(1)*x(2)*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(5*(x(1)^2/2 + x(2)^2/2)) - (x(1)*x(2)*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(3/2) - pi^2*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*sin(2*pi*x(1))*sin(2*pi*x(2));
                     H22 = (2*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(1/2) + 2*pi^2*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*cos(2*pi*x(2)) - (x(2)^2*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(5*(x(1)^2/2 + x(2)^2/2)) - (x(2)^2*exp(-(x(1)^2/2 + x(2)^2/2)^(1/2)/5))/(x(1)^2/2 + x(2)^2/2)^(3/2) - pi^2*exp(cos(2*pi*x(1))/2 + cos(2*pi*x(2))/2)*sin(2*pi*x(2))^2;
                     hval = [H11, H12;H21, H22];
                case "rosenbrock"
                    hval=[ 1200*x(1)^2 - 400*x(2) + 2,  -400*x(1);-400*x(1), 200 ];
                case "beale"
                     H11 = 2*(x(2) - 1)^2 + 2*(x(2)^2 - 1)^2 + 2*(x(2)^3 - 1)^2;
                     H12 = 4*x(2)*(x(1)*(x(2)^2 - 1) + 9/4) + 6*x(2)^2*(x(1)*(x(2)^3 - 1) + 21/8) + 4*x(1)*(x(2) - 1) + 4*x(1)*x(2)*(x(2)^2 - 1) + 6*x(1)*x(2)^2*(x(2)^3 - 1) + 3; 
                     H22 =  8*x(1)^2*x(2)^2 + 18*x(1)^2*x(2)^4 + 4*x(1)*(x(1)*(x(2)^2 - 1) + 9/4) + 2*x(1)^2 + 12*x(1)*x(2)*(x(1)*(x(2)^3 - 1) + 21/8);
                     hval= [H11, H12;H12, H22];
                case "goldsteinprice"
                     H11 =2*((8*x(1) - 12*x(2))*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) - (2*x(1) - 3*x(2))^2*(36*x(2) - 24*x(1) + 32))*((6*x(1) + 6*x(2) - 14)*(x(1) + x(2) + 1)^2 + (2*x(1) + 2*x(2) + 2)*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19)) + ((2*x(1) - 3*x(2))^2*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) + 30)*(12*x(1)*x(2) - 28*x(2) - 28*x(1) + 2*(2*x(1) + 2*x(2) + 2)*(6*x(1) + 6*x(2) - 14) + 6*(x(1) + x(2) + 1)^2 + 6*x(1)^2 + 6*x(2)^2 + 38) + ((x(1) + x(2) + 1)^2*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19) + 1)*(384*x(2) - 256*x(1) - 288*x(1)*x(2) + 24*(2*x(1) - 3*x(2))^2 - 2*(8*x(1) - 12*x(2))*(36*x(2) - 24*x(1) + 32) + 96*x(1)^2 + 216*x(2)^2 + 144);
                     H12 = ((8*x(1) - 12*x(2))*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) - (2*x(1) - 3*x(2))^2*(36*x(2) - 24*x(1) + 32))*((6*x(1) + 6*x(2) - 14)*(x(1) + x(2) + 1)^2 + (2*x(1) + 2*x(2) + 2)*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19)) - ((x(1) + x(2) + 1)^2*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19) + 1)*(576*x(2) - 384*x(1) - 432*x(1)*x(2) + 36*(2*x(1) - 3*x(2))^2 - (12*x(1) - 18*x(2))*(36*x(2) - 24*x(1) + 32) - (8*x(1) - 12*x(2))*(54*x(2) - 36*x(1) + 48) + 144*x(1)^2 + 324*x(2)^2 + 216) - ((12*x(1) - 18*x(2))*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) - (2*x(1) - 3*x(2))^2*(54*x(2) - 36*x(1) + 48))*((6*x(1) + 6*x(2) - 14)*(x(1) + x(2) + 1)^2 + (2*x(1) + 2*x(2) + 2)*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19)) + ((2*x(1) - 3*x(2))^2*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) + 30)*(12*x(1)*x(2) - 28*x(2) - 28*x(1) + 2*(2*x(1) + 2*x(2) + 2)*(6*x(1) + 6*x(2) - 14) + 6*(x(1) + x(2) + 1)^2 + 6*x(1)^2 + 6*x(2)^2 + 38);
                     H22 = ((2*x(1) - 3*x(2))^2*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) + 30)*(12*x(1)*x(2) - 28*x(2) - 28*x(1) + 2*(2*x(1) + 2*x(2) + 2)*(6*x(1) + 6*x(2) - 14) + 6*(x(1) + x(2) + 1)^2 + 6*x(1)^2 + 6*x(2)^2 + 38) - 2*((12*x(1) - 18*x(2))*(12*x(1)^2 - 36*x(1)*x(2) - 32*x(1) + 27*x(2)^2 + 48*x(2) + 18) - (2*x(1) - 3*x(2))^2*(54*x(2) - 36*x(1) + 48))*((6*x(1) + 6*x(2) - 14)*(x(1) + x(2) + 1)^2 + (2*x(1) + 2*x(2) + 2)*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19)) + ((x(1) + x(2) + 1)^2*(3*x(1)^2 + 6*x(1)*x(2) - 14*x(1) + 3*x(2)^2 - 14*x(2) + 19) + 1)*(864*x(2) - 576*x(1) - 648*x(1)*x(2) + 54*(2*x(1) - 3*x(2))^2 - 2*(12*x(1) - 18*x(2))*(54*x(2) - 36*x(1) + 48) + 216*x(1)^2 + 486*x(2)^2 + 324);
                     hval = [H11, H12;H12, H22];
                case "booth"
                    hval=[10,8;8,10];
                case "matyas"
                   hval= [13/25, -12/25; -12/25, 13/25];
                case "himmelblau"
                    H11 = 12*x(1)^2 + 4*x(2) - 42;
                    H12 = 4*x(1) + 4*x(2);  
                     H22 = 12*x(2)^2 + 4*x(1) - 26;
                     hval= [H11, H12; H12, H22];
                case "mccormick"
                     hval= [2 - sin(x(1) + x(2)), - sin(x(1) + x(2)) - 2; - sin(x(1) + x(2)) - 2,  2 - sin(x(1) + x(2))];
                case "schaffer"
                     H11 = (3*x(1)^2*(sin(x(1)^2 - x(2)^2)^2 - 1/2))/(125000*(x(1)^2/1000 + x(2)^2/1000 + 1)^4) - (sin(x(1)^2 - x(2)^2)^2 - 1/2)/(250*(x(1)^2/1000 + x(2)^2/1000 + 1)^3) + (4*cos(x(1)^2 - x(2)^2)*sin(x(1)^2 - x(2)^2))/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 + (8*x(1)^2*cos(x(1)^2 - x(2)^2)^2)/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 - (8*x(1)^2*sin(x(1)^2 - x(2)^2)^2)/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 - (4*x(1)^2*cos(x(1)^2 - x(2)^2)*sin(x(1)^2 - x(2)^2))/(125*(x(1)^2/1000 + x(2)^2/1000 + 1)^3);
                     H12 = (3*x(1)*x(2)*(sin(x(1)^2 - x(2)^2)^2 - 1/2))/(125000*(x(1)^2/1000 + x(2)^2/1000 + 1)^4) - (8*x(1)*x(2)*cos(x(1)^2 - x(2)^2)^2)/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 + (8*x(1)*x(2)*sin(x(1)^2 - x(2)^2)^2)/(x(1)^2/1000 + x(2)^2/1000 + 1)^2; 
                     H22 = (3*x(2)^2*(sin(x(1)^2 - x(2)^2)^2 - 1/2))/(125000*(x(1)^2/1000 + x(2)^2/1000 + 1)^4) - (sin(x(1)^2 - x(2)^2)^2 - 1/2)/(250*(x(1)^2/1000 + x(2)^2/1000 + 1)^3) - (4*cos(x(1)^2 - x(2)^2)*sin(x(1)^2 - x(2)^2))/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 + (8*x(2)^2*cos(x(1)^2 - x(2)^2)^2)/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 - (8*x(2)^2*sin(x(1)^2 - x(2)^2)^2)/(x(1)^2/1000 + x(2)^2/1000 + 1)^2 + (4*x(2)^2*cos(x(1)^2 - x(2)^2)*sin(x(1)^2 - x(2)^2))/(125*(x(1)^2/1000 + x(2)^2/1000 + 1)^3);
                     hval = [H11, H12; H12, H22];
                otherwise
                    disp("Wrong Choice")
            end
        end
    end
end